<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Related</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <meta http-Equiv="Cache-Control" Content="cache">
	<meta http-Equiv="Pragma" Content="cache">
	<meta http-Equiv="Expires" Content="1000">

    <!-- Loading Elements Styles -->
     <link type="text/css" href="/static/css/styles.min.css" rel="stylesheet">
    <!-- Loading Font Styles -->
    <link type="text/css" href="/static/page_builder/css/iconfont-style.css" rel="stylesheet">

    <!-- HTML5 shim, for IE6-8 support of HTML5 elements. All other JS at the end of file. -->
    <!--[if lt IE 9]>
      <script src="js/html5shiv.js"></script>
      <script src="js/respond.min.js"></script>
    <![endif]-->
</head>
<body>

    <div id="page" class="page">

        <!-- {% if 0 %} -->
            <div class="d-flex justify-content-center">
                <br><br><h3>SHOW</h3><br><br>
            </div>
        <!-- {% endif %} -->

        <!-- {% if 0 %} -->
            <div class="hidden">
        <!-- {% endif %} -->

            {% if not request.GET.ajax %}
                <div class="fullwidth margin-top-20 test">
                    <div class="container">
                        <div class="row padding-top-20 padding-bottom-20">

                            {% load edw_tags %}
                            {% if publication.related_data_marts %}
                                {% for data_mart in publication.related_data_marts %}

                                        <div class="ex-data-mart-container">
                                            <div class="col-md-12">
                                                <!--{% compactjson as data_entry_points %}
                                                {
                                                    "{{ data_mart.id }}": {
                                                        "order": {{ forloop.counter }},
                                                        "name": "{{ data_mart.name }}",
                                                        "template_name": "related",
                                                        "request_params": [{% if data_mart.is_subjective %}"subj={{ publication.id }}",{% endif %}"id__in!={{ publication.id }}","limit=4"]
                                                    }
                                                }
                                                {% endcompactjson %}-->
                                                <div class="ex-data-mart border-color3 color2 ex-catalog-grid-4-col" data-selected-entry-point-id="{{ data_mart.id }}" data-data-mart-pk="{{ data_mart.id }}" data-entry-points="{{ data_entry_points }}">
                                                </div>
                                            </div>
                                        </div>

                                {% endfor %}
                            {% else %}
                                {% if publication.default_data_mart %} <!-- todo: проверка витрины на is_subjective  -->
                                    <div class="ex-data-mart-container">
                                        <div class="col-md-12">
                                            <!--{% compactjson as data_entry_points %}
                                            {
                                                "{{ publication.default_data_mart.id }}": {
                                                    "name": "{{ publication.default_data_mart.name }}",
                                                    "template_name": "related",
                                                    "request_params": [{% if publication.default_data_mart.is_subjective %}"subj={{ publication.id }}",{% endif %}"id__in!={{ publication.id }}","limit=4"]
                                                }
                                            }
                                            {% endcompactjson %}-->
                                            <div class="ex-data-mart border-color3 color2 ex-catalog-grid-4-col" data-selected-entry-point-id="{{ publication.default_data_mart.id }}" data-data-mart-pk="{{ publication.default_data_mart.id }}" data-entry-points="{{ data_entry_points }}">
                                            </div>
                                        </div>
                                  </div>
                                {% endif %}
                            {% endif %}
                        </div>
                    </div>
                </div>
            {% endif %}

        <!-- {% if 0 %} -->
            </div><!-- /.hidden -->
        <!-- {% endif %} -->

    </div><!-- /#page -->
</body>
</html>
